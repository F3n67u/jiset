{"kind":"Language","params":[],"steps":[{"tokens":["If",{"id":"module"},"is","not","a","Source","Text","Module","Record",",","then",{"steps":[{"tokens":["Perform","?",{"id":"module"},".","Instantiate","(",")","."]},{"tokens":["Return",{"id":"index"},"."]}]}]},{"tokens":["If",{"id":"module"},".","[","[","Status","]","]","is",{"code":"\"instantiating\""},",",{"code":"\"instantiated\""},",","or",{"code":"\"evaluated\""},",","then",{"steps":[{"tokens":["Return",{"id":"index"},"."]}]}]},{"tokens":["Assert",":",{"id":"module"},".","[","[","Status","]","]","is",{"code":"\"uninstantiated\""},"."]},{"tokens":["Set",{"id":"module"},".","[","[","Status","]","]","to",{"code":"\"instantiating\""},"."]},{"tokens":["Set",{"id":"module"},".","[","[","DFSIndex","]","]","to",{"id":"index"},"."]},{"tokens":["Set",{"id":"module"},".","[","[","DFSAncestorIndex","]","]","to",{"id":"index"},"."]},{"tokens":["Set",{"id":"index"},"to",{"id":"index"},"+","1","."]},{"tokens":["Append",{"id":"module"},"to",{"id":"stack"},"."]},{"tokens":["For","each","String",{"id":"required"},"that","is","an","element","of",{"id":"module"},".","[","[","RequestedModules","]","]",",","do",{"steps":[{"tokens":["Let",{"id":"requiredModule"},"be","?","HostResolveImportedModule","(",{"id":"module"},",",{"id":"required"},")","."]},{"tokens":["Set",{"id":"index"},"to","?","InnerModuleInstantiation","(",{"id":"requiredModule"},",",{"id":"stack"},",",{"id":"index"},")","."]},{"tokens":["Assert",":",{"id":"requiredModule"},".","[","[","Status","]","]","is","either",{"code":"\"instantiating\""},",",{"code":"\"instantiated\""},",","or",{"code":"\"evaluated\""},"."]},{"tokens":["Assert",":",{"id":"requiredModule"},".","[","[","Status","]","]","is",{"code":"\"instantiating\""},"if","and","only","if",{"id":"requiredModule"},"is","in",{"id":"stack"},"."]},{"tokens":["If",{"id":"requiredModule"},".","[","[","Status","]","]","is",{"code":"\"instantiating\""},",","then",{"steps":[{"tokens":["Assert",":",{"id":"requiredModule"},"is","a","Source","Text","Module","Record","."]},{"tokens":["Set",{"id":"module"},".","[","[","DFSAncestorIndex","]","]","to","min","(",{"id":"module"},".","[","[","DFSAncestorIndex","]","]",",",{"id":"requiredModule"},".","[","[","DFSAncestorIndex","]","]",")","."]}]}]}]}]},{"tokens":["Perform","?","ModuleDeclarationEnvironmentSetup","(",{"id":"module"},")","."]},{"tokens":["Assert",":",{"id":"module"},"occurs","exactly","once","in",{"id":"stack"},"."]},{"tokens":["Assert",":",{"id":"module"},".","[","[","DFSAncestorIndex","]","]","is","less","than","or","equal","to",{"id":"module"},".","[","[","DFSIndex","]","]","."]},{"tokens":["If",{"id":"module"},".","[","[","DFSAncestorIndex","]","]","equals",{"id":"module"},".","[","[","DFSIndex","]","]",",","then",{"steps":[{"tokens":["Let",{"id":"done"},"be",{"value":"false"},"."]},{"tokens":["Repeat",",","while",{"id":"done"},"is",{"value":"false"},",",{"steps":[{"tokens":["Let",{"id":"requiredModule"},"be","the","last","element","in",{"id":"stack"},"."]},{"tokens":["Remove","the","last","element","of",{"id":"stack"},"."]},{"tokens":["Set",{"id":"requiredModule"},".","[","[","Status","]","]","to",{"code":"\"instantiated\""},"."]},{"tokens":["If",{"id":"requiredModule"},"and",{"id":"module"},"are","the","same","Module","Record",",","set",{"id":"done"},"to",{"value":"true"},"."]}]}]}]}]},{"tokens":["Return",{"id":"index"},"."]}],"length":0,"filename":"es2000/algorithm/15.2.1.16.4.1InnerModuleInstantiation(module,stack,index)0.json"}