{"kind":"Method","params":["promise","onFulfilled","onRejected","resultCapability"],"steps":[{"tokens":["Assert",":","IsPromise","(",{"id":"promise"},")","is",{"value":"true"},"."]},{"tokens":["Assert",":",{"id":"resultCapability"},"is","a","PromiseCapability","record","."]},{"tokens":["If","IsCallable","(",{"id":"onFulfilled"},")","is",{"value":"false"},",","then",{"steps":[{"tokens":["Let",{"id":"onFulfilled"},"be",{"code":"\"Identity\""},"."]}]}]},{"tokens":["If","IsCallable","(",{"id":"onRejected"},")","is",{"value":"false"},",","then",{"steps":[{"tokens":["Let",{"id":"onRejected"},"be",{"code":"\"Thrower\""},"."]}]}]},{"tokens":["Let",{"id":"fulfillReaction"},"be","the","PromiseReaction","{","[","[","Capabilities","]","]",":",{"id":"resultCapability"},",","[","[","Handler","]","]",":",{"id":"onFulfilled"},"}","."]},{"tokens":["Let",{"id":"rejectReaction"},"be","the","PromiseReaction","{","[","[","Capabilities","]","]",":",{"id":"resultCapability"},",","[","[","Handler","]","]",":",{"id":"onRejected"},"}","."]},{"tokens":["If","the","value","of",{"id":"promise"},"'","s","[","[","PromiseState","]","]","internal","slot","is",{"code":"\"pending\""},",","then",{"steps":[{"tokens":["Append",{"id":"fulfillReaction"},"as","the","last","element","of","the","List","that","is","the","value","of",{"id":"promise"},"'","s","[","[","PromiseFulfillReactions","]","]","internal","slot","."]},{"tokens":["Append",{"id":"rejectReaction"},"as","the","last","element","of","the","List","that","is","the","value","of",{"id":"promise"},"'","s","[","[","PromiseRejectReactions","]","]","internal","slot","."]}]}]},{"tokens":["Else","if","the","value","of",{"id":"promise"},"'","s","[","[","PromiseState","]","]","internal","slot","is",{"code":"\"fulfilled\""},",","then",{"steps":[{"tokens":["Let",{"id":"value"},"be","the","value","of",{"id":"promise"},"'","s","[","[","PromiseResult","]","]","internal","slot","."]},{"tokens":["Perform","EnqueueJob","(",{"code":"\"PromiseJobs\""},",","PromiseReactionJob",",","«",{"id":"fulfillReaction"},",",{"id":"value"},"»",")","."]}]}]},{"tokens":["Else",",",{"steps":[{"tokens":["Assert",":","The","value","of",{"id":"promise"},"'","s","[","[","PromiseState","]","]","internal","slot","is",{"code":"\"rejected\""},"."]},{"tokens":["Let",{"id":"reason"},"be","the","value","of",{"id":"promise"},"'","s","[","[","PromiseResult","]","]","internal","slot","."]},{"tokens":["If","the","value","of",{"id":"promise"},"'","s","[","[","PromiseIsHandled","]","]","internal","slot","is",{"value":"false"},",","perform","HostPromiseRejectionTracker","(",{"id":"promise"},",",{"code":"\"handle\""},")","."]},{"tokens":["Perform","EnqueueJob","(",{"code":"\"PromiseJobs\""},",","PromiseReactionJob",",","«",{"id":"rejectReaction"},",",{"id":"reason"},"»",")","."]}]}]},{"tokens":["Set",{"id":"promise"},"'","s","[","[","PromiseIsHandled","]","]","internal","slot","to",{"value":"true"},"."]},{"tokens":["Return",{"id":"resultCapability"},".","[","[","Promise","]","]","."]}],"length":4,"filename":"es2000/algorithm/GLOBAL.PerformPromiseThen.json"}