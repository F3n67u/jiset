{"kind":"Method","params":["typedArray","index","value","timeout"],"steps":[{"tokens":["Let",{"id":"buffer"},"be","?","ValidateSharedIntegerTypedArray","(",{"id":"typedArray"},",",{"value":"true"},")","."]},{"tokens":["Let",{"id":"i"},"be","?","ValidateAtomicAccess","(",{"id":"typedArray"},",",{"id":"index"},")","."]},{"tokens":["Let",{"id":"v"},"be","?","ToInt32","(",{"id":"value"},")","."]},{"tokens":["Let",{"id":"q"},"be","?","ToNumber","(",{"id":"timeout"},")","."]},{"tokens":["If",{"id":"q"},"is",{"value":"NaN"},",","let",{"id":"t"},"be",{"value":"+∞"},",","else","let",{"id":"t"},"be","max","(",{"id":"q"},",","0",")","."]},{"tokens":["Let",{"id":"B"},"be","AgentCanSuspend","(",")","."]},{"tokens":["If",{"id":"B"},"is",{"value":"false"},",","throw","a",{"value":"TypeError"},"exception","."]},{"tokens":["Let",{"id":"block"},"be",{"id":"buffer"},".","[","[","ArrayBufferData","]","]","."]},{"tokens":["Let",{"id":"offset"},"be",{"id":"typedArray"},".","[","[","ByteOffset","]","]","."]},{"tokens":["Let",{"id":"indexedPosition"},"be","(",{"id":"i"},"×","4",")","+",{"id":"offset"},"."]},{"tokens":["Let",{"id":"WL"},"be","GetWaiterList","(",{"id":"block"},",",{"id":"indexedPosition"},")","."]},{"tokens":["Perform","EnterCriticalSection","(",{"id":"WL"},")","."]},{"tokens":["Let",{"id":"w"},"be","!","AtomicLoad","(",{"id":"typedArray"},",",{"id":"i"},")","."]},{"tokens":["If",{"id":"v"},"is","not","equal","to",{"id":"w"},",","then",{"steps":[{"tokens":["Perform","LeaveCriticalSection","(",{"id":"WL"},")","."]},{"tokens":["Return","the","String",{"value":"\"not-equal\""},"."]}]}]},{"tokens":["Let",{"id":"W"},"be","AgentSignifier","(",")","."]},{"tokens":["Perform","AddWaiter","(",{"id":"WL"},",",{"id":"W"},")","."]},{"tokens":["Let",{"id":"awoken"},"be","Suspend","(",{"id":"WL"},",",{"id":"W"},",",{"id":"t"},")","."]},{"tokens":["If",{"id":"awoken"},"is",{"value":"true"},",","then",{"steps":[{"tokens":["Assert",":",{"id":"W"},"is","not","on","the","list","of","waiters","in",{"id":"WL"},"."]}]}]},{"tokens":["Else",",",{"steps":[{"tokens":["Perform","RemoveWaiter","(",{"id":"WL"},",",{"id":"W"},")","."]}]}]},{"tokens":["Perform","LeaveCriticalSection","(",{"id":"WL"},")","."]},{"tokens":["If",{"id":"awoken"},"is",{"value":"true"},",","return","the","String",{"value":"\"ok\""},"."]},{"tokens":["Return","the","String",{"value":"\"timed-out\""},"."]}],"filename":"es2018/algorithm/Global.Atomics.wait.json"}