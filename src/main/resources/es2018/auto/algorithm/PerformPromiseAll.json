{"kind":"RuntimeSemantics","params":["iteratorRecord","constructor","resultCapability"],"steps":[{"tokens":["Assert",":",{"id":"constructor"},"is","a","constructor","function","."]},{"tokens":["Assert",":",{"id":"resultCapability"},"is","a","PromiseCapability","Record","."]},{"tokens":["Let",{"id":"values"},"be","a","new","empty","List","."]},{"tokens":["Let",{"id":"remainingElementsCount"},"be","a","new","Record","{","[","[","Value","]","]",":","1","}","."]},{"tokens":["Let",{"id":"index"},"be","0","."]},{"tokens":["Repeat",",",{"steps":[{"tokens":["Let",{"id":"next"},"be","IteratorStep","(",{"id":"iteratorRecord"},")","."]},{"tokens":["If",{"id":"next"},"is","an","abrupt","completion",",","set",{"id":"iteratorRecord"},".","[","[","Done","]","]","to",{"value":"true"},"."]},{"tokens":["ReturnIfAbrupt","(",{"id":"next"},")","."]},{"tokens":["If",{"id":"next"},"is",{"value":"false"},",","then",{"steps":[{"tokens":["Set",{"id":"iteratorRecord"},".","[","[","Done","]","]","to",{"value":"true"},"."]},{"tokens":["Set",{"id":"remainingElementsCount"},".","[","[","Value","]","]","to",{"id":"remainingElementsCount"},".","[","[","Value","]","]","-","1","."]},{"tokens":["If",{"id":"remainingElementsCount"},".","[","[","Value","]","]","is","0",",","then",{"steps":[{"tokens":["Let",{"id":"valuesArray"},"be","CreateArrayFromList","(",{"id":"values"},")","."]},{"tokens":["Perform","?","Call","(",{"id":"resultCapability"},".","[","[","Resolve","]","]",",",{"value":"undefined"},",","«",{"id":"valuesArray"},"»",")","."]}]}]},{"tokens":["Return",{"id":"resultCapability"},".","[","[","Promise","]","]","."]}]}]},{"tokens":["Let",{"id":"nextValue"},"be","IteratorValue","(",{"id":"next"},")","."]},{"tokens":["If",{"id":"nextValue"},"is","an","abrupt","completion",",","set",{"id":"iteratorRecord"},".","[","[","Done","]","]","to",{"value":"true"},"."]},{"tokens":["ReturnIfAbrupt","(",{"id":"nextValue"},")","."]},{"tokens":["Append",{"value":"undefined"},"to",{"id":"values"},"."]},{"tokens":["Let",{"id":"nextPromise"},"be","?","Invoke","(",{"id":"constructor"},",",{"code":"\"resolve\""},",","«",{"id":"nextValue"},"»",")","."]},{"tokens":["Let",{"id":"steps"},"be","the","algorithm","steps","defined","in","Promise",".","all","Resolve","Element","Functions","."]},{"tokens":["Let",{"id":"resolveElement"},"be","CreateBuiltinFunction","(",{"id":"steps"},",","«","[","[","AlreadyCalled","]","]",",","[","[","Index","]","]",",","[","[","Values","]","]",",","[","[","Capability","]","]",",","[","[","RemainingElements","]","]","»",")","."]},{"tokens":["Set",{"id":"resolveElement"},".","[","[","AlreadyCalled","]","]","to","a","new","Record","{","[","[","Value","]","]",":",{"value":"false"},"}","."]},{"tokens":["Set",{"id":"resolveElement"},".","[","[","Index","]","]","to",{"id":"index"},"."]},{"tokens":["Set",{"id":"resolveElement"},".","[","[","Values","]","]","to",{"id":"values"},"."]},{"tokens":["Set",{"id":"resolveElement"},".","[","[","Capability","]","]","to",{"id":"resultCapability"},"."]},{"tokens":["Set",{"id":"resolveElement"},".","[","[","RemainingElements","]","]","to",{"id":"remainingElementsCount"},"."]},{"tokens":["Set",{"id":"remainingElementsCount"},".","[","[","Value","]","]","to",{"id":"remainingElementsCount"},".","[","[","Value","]","]","+","1","."]},{"tokens":["Perform","?","Invoke","(",{"id":"nextPromise"},",",{"code":"\"then\""},",","«",{"id":"resolveElement"},",",{"id":"resultCapability"},".","[","[","Reject","]","]","»",")","."]},{"tokens":["Set",{"id":"index"},"to",{"id":"index"},"+","1","."]}]}]}],"length":3,"filename":"es2000/algorithm/PerformPromiseAll.json"}