% load packages
\usepackage{float}
\usepackage{amsmath,amsfonts}
\usepackage[ruled, vlined]{algorithm2e}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{makecell}
\usepackage{galois}
\usepackage{mathpartir}
\usepackage{bussproofs}
\usepackage{mathtools}
\usepackage{colortbl}
\usepackage{hhline}
\usepackage{stmaryrd}
\usepackage{microtype}
\usepackage{hyperref}
\usepackage{balance}

% basic
\newcommand{\inred}[1]{{\color{red}{#1}}}
\newcommand{\todo}{\inred{TODO}}
\newcommand{\name}[1]{\textsf{#1}}
\newcommand{\sname}[1]{\name{\small #1}}
\newcommand{\stextbf}[1]{\textbf{\small #1}}
\definecolor{dkgreen}{rgb}{0,0.5,0}

% tools
\newcommand{\tool}{\sname{JEDIT}}
\newcommand{\bigtool}{\name{JEDIT}}
\newcommand{\jiset}{\sname{JISET}}
\newcommand{\jest}{\sname{JEST}}
\newcommand{\jstar}{\sname{JSTAR}}
\newcommand{\asfsdf}{\textsc{Asf+Sdf}}

% ECMAScript Intermediate Reprentations (IRES)
\newcommand{\ires}{\text{IR}_\text{ES}}
\lstdefinestyle{ires}{
  frame=tb,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=fixed,
  basicstyle={\footnotesize\ttfamily},
  numberstyle=\tiny\color{darkgray},
  numbers=none,
  numbersep=5pt,
  keywordstyle=\color{blue},
  comment=[l]{//},
  morecomment=[s]{/*}{*/},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  frame=single,
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3,
}

% JavaScript code style
\lstdefinelanguage{JavaScript}{
  keywords={async, await, break, case, catch, class, const, continue, debugger,
    default, delete, do, else, enum, export, extends, false, finally, for,
    function, if, import, in, of, instanceof, new, null, return, super, switch, this,
    throw, true, try, typeof, let, var, void, while, with, yield},
  keywordstyle=\color{blue}\bfseries,
  ndkeywordstyle=\color{darkgray}\bfseries,
  identifierstyle=\color{black},
  numberstyle=\tiny\color{darkgray},
  numbers=none,
  numbersep=5pt,
  sensitive=false,
  comment=[l]{//},
  morecomment=[s]{/*}{*/},
  commentstyle=\color{dkgreen},
  stringstyle=\color{red}\ttfamily,
  morestring=[b]',
  morestring=[b]",
  morestring=[b]`
}
\lstdefinestyle{JS}{
  language=JavaScript,
  extendedchars=true,
  basicstyle=\footnotesize\ttfamily,
  showstringspaces=false,
  showspaces=false,
  tabsize=2,
  breaklines=true,
  showtabs=false,
  captionpos=b
}

% codes
\newcommand{\jscode}[1]{\text{\lstinline[style=JS]!#1!}} 
\newcommand{\ircode}[1]{\text{\lstinline[style=ires]!#1!}}
\newcommand{\code}[1]{\texttt{#1}}
\newcommand{\kwdef}{\code{def}}
\newcommand{\kwret}{\code{ret}}
\newcommand{\kwif}{\code{if}}
\newcommand{\kwrl}{\code{(}}
\newcommand{\kwrr}{\code{)}}
\newcommand{\kwcl}{\code{\{}}
\newcommand{\kwcr}{\code{\}}}
\newcommand{\kwsl}{\code{[}}
\newcommand{\kwsr}{\code{]}}

% basic
\DeclareMathAlphabet{\mathpzc}{T1}{pzc}{m}{it}
\newcommand{\powerset}[1]{\mathcal{P}(#1)}
\newcommand{\abs}[1]{\widehat{#1}}
\newcommand{\finmap}{{\xrightarrow[]{\text{fin}}}}
\newcommand{\mapstos}{\;\dot{\mapsto}\;}
\newcommand{\Dom}{\name{Dom}}
\DeclarePairedDelimiter{\norm}{\lvert}{\rvert} 

% notations
\newcommand{\progset}{\mathfrak{P}}
\newcommand{\prog}{P}
\newcommand{\getfunc}{\code{func}}
\newcommand{\getinst}{\code{inst}}
\newcommand{\getnext}{\code{next}}
\newcommand{\funcset}{\mathcal{F}}
\newcommand{\func}{f}
\newcommand{\labset}{\mathcal{L}}
\newcommand{\lab}{\mathpzc{l}}
\newcommand{\labdot}[1]{{{\bullet_{\lab_{#1}}}}}
\newcommand{\ilab}{\lab_\iota}
\newcommand{\labnext}{\name{next}}
\newcommand{\op}{\name{op}}
\newcommand{\ops}{\dot{\name{op}}}
\newcommand{\instset}{\mathcal{I}}
\newcommand{\inst}{i}
\newcommand{\exprset}{\mathcal{E}}
\newcommand{\expr}{e}
\newcommand{\referset}{\mathcal{R}}
\newcommand{\refer}{r}
\newcommand{\varset}{\mathcal{X}}
\newcommand{\varx}{\code{x}}
\newcommand{\vart}{\code{t}}
\newcommand{\varf}{\code{f}}
\newcommand{\varp}{\code{p}}

% values
\newcommand{\valset}{\mathbb{V}}
\newcommand{\val}{v}
\newcommand{\pvalset}{\valset_\name{prim}}
\newcommand{\pval}{\val^\name{p}}
\newcommand{\strset}{\valset_\name{str}}
\newcommand{\str}{s}
\newcommand{\boolset}{\valset_\name{bool}}
\newcommand{\bool}{b}
\newcommand{\intset}{\valset_\name{int}}
\newcommand{\true}{\code{\#t}}
\newcommand{\false}{\code{\#f}}

% JavaScript ASTs
\newcommand{\treeset}{\mathbb{T}}
\newcommand{\tree}{t}
\newcommand{\subtree}{\lhd}
\newcommand{\treetop}{\code{\#}}
\newcommand{\ty}{\tau}
\newcommand{\eval}{\code{eval}}
\newcommand{\nterm}[1]{\textit{\small #1}}
\newcommand{\term}[1]{\langle #1 \rangle}

% states
\newcommand{\stset}{\mathbb{S}}
\newcommand{\st}{\sigma}
\newcommand{\istset}{\stset_\iota}
\newcommand{\ist}{\st_\iota}

% heaps
\newcommand{\heapset}{\mathbb{H}}
\newcommand{\heap}{h}

% contexts
\newcommand{\ctxtset}{\mathbb{C}}
\newcommand{\ctxts}{\overline{\ctxt}}
\newcommand{\ctxt}{c}

% environments
\newcommand{\envset}{\mathbb{E}}
\newcommand{\env}{\rho}

% addresses
\newcommand{\addrset}{\mathbb{A}}
\newcommand{\addr}{a}

% objects
\newcommand{\objset}{\mathbb{O}}
\newcommand{\obj}{o}

% semantics
\newcommand{\sem}[1]{\llbracket{#1}\rrbracket}
\newcommand{\asem}[1]{\abs{\sem{#1}}}
\newcommand{\trans}{\leadsto}

% transfer function
\newcommand{\transfer}{F}
\newcommand{\atransfer}{\abs{\transfer}}

% partial evaluation
\newcommand{\peval}[1]{\textbf{PE}\sem{#1}}

% transformations
\newcommand{\transform}{T}
\newcommand{\transformi}{\transform_\inst}
\newcommand{\transforme}{\transform_\expr}

% abstract states
\newcommand{\aelemset}{\abs{\mathbb{D}}}
\newcommand{\aelem}{\abs{d}}
\newcommand{\iaelem}{\aelem_\iota}

% abstract calling contexts
\newcommand{\actxtset}{\abs{\ctxtset}}
\newcommand{\actxt}{\abs{\ctxt}}

% abstract environments
\newcommand{\aenvset}{\abs{\envset}}
\newcommand{\aenv}{\abs{\env}}
\newcommand{\afsenvset}{\aenvset_\name{fs}}
\newcommand{\afsenv}{\aenv_\name{fs}}

% abstract values
\newcommand{\avalset}{\abs{\valset}}
\newcommand{\aval}{\abs{\val}}

% syntactic views
\newcommand{\atreeset}{\abs{\treeset}}
\newcommand{\atree}{\abs{\tree}}

% abstract operations
\newcommand{\join}{\sqcup}
\newcommand{\bigjoin}{\bigsqcup}
\newcommand{\order}{\sqsubseteq}
\newcommand{\revorder}{\sqsupseteq}

% least fixed point
\newcommand{\lfp}{\textbf{lfp}}
